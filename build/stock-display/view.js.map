{"version":3,"file":"stock-display/view.js","mappings":"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","sources":["webpack://gb-blocks/./src/stock-display/view.js"],"sourcesContent":["document.addEventListener('DOMContentLoaded', function () {\n    const stockTrackers = document.querySelectorAll('.stock-tracker-root');\n\n    stockTrackers.forEach(function (tracker) {\n        let activeTab = 'indices';\n        const tableContainer = tracker.querySelector('.stock-table-container');\n        const loadingDiv = tracker.querySelector('.stock-loading');\n\n        // Initialize tabs\n        const tabs = tracker.querySelectorAll('.stock-tab');\n        tabs.forEach(tab => {\n            tab.addEventListener('click', () => {\n                // Update active tab\n                tabs.forEach(t => t.classList.remove('active'));\n                tab.classList.add('active');\n                activeTab = tab.dataset.tab;\n                fetchStocks();\n            });\n        });\n\n        // async function fetchStocks() {\n        //     try {\n        //         loadingDiv.style.display = 'block';\n        //         tableContainer.style.display = 'none';\n\n        //         const response = await fetch(\n        //             `${stockTrackerData.apiUrl}/${activeTab}`,\n        //             {\n        //                 headers: {\n        //                     'X-WP-Nonce': stockTrackerData.nonce\n        //                 }\n        //             }\n        //         );\n\n        //         if (!response.ok) throw new Error('Network response was not ok');\n\n        //         const stocks = await response.json();\n        //         renderStocks(stocks);\n\n        //         loadingDiv.style.display = 'none';\n        //         tableContainer.style.display = 'block';\n        //     } catch (error) {\n        //         console.error('Error fetching stocks:', error);\n        //         loadingDiv.textContent = 'Error loading stocks data. Please try again.';\n        //     }\n        // }\n\n        async function fetchStocks() {\n            try {\n                if (!loadingDiv || !tableContainer) {\n                    console.error(\"loadingDiv or tableContainer is not found in the DOM.\");\n                    return;\n                }\n\n                loadingDiv.style.display = 'block';\n                tableContainer.style.display = 'none';\n\n                const response = await fetch(`${stockTrackerData.apiUrl}/${activeTab}`, {\n                    headers: {\n                        'X-WP-Nonce': stockTrackerData.nonce\n                    }\n                });\n\n                if (!response.ok) {\n                    throw new Error(`HTTP error! Status: ${response.status}`);\n                }\n\n                let stocks;\n                try {\n                    stocks = await response.json();\n                } catch (jsonError) {\n                    console.error(\"Error parsing JSON:\", jsonError);\n                    throw new Error(\"Invalid JSON response from server\");\n                }\n\n                renderStocks(stocks);\n\n                loadingDiv.style.display = 'none';\n                tableContainer.style.display = 'block';\n            } catch (error) {\n                console.error(\"Error fetching stocks:\", error);\n                loadingDiv.textContent = \"Error loading stocks data. Please try again.\";\n            }\n        }\n\n        function renderStocks(stocks) {\n            const tbody = tableContainer.querySelector('tbody');\n            tbody.innerHTML = stocks.map(stock => {\n                // Convert values to numbers before using toFixed\n                const ltp = parseFloat(stock.ltp);\n                const chg = parseFloat(stock.chg);\n                const chgPercent = parseFloat(stock.chg_percent);\n                const adRatio = parseFloat(stock.ad_ratio);\n\n                return `\n                    <tr>\n                        <td class=\"stock-name\">${stock.name}</td>\n                        <td class=\"stock-ltp\">${!isNaN(ltp) ? ltp.toFixed(2) : 'N/A'}</td>\n                        <td class=\"stock-chg ${chg >= 0 ? 'positive' : 'negative'}\">\n                            ${chg >= 0 ? '+' : ''}${!isNaN(chg) ? chg.toFixed(2) : 'N/A'}\n                        </td>\n                        <td class=\"stock-percent ${chgPercent >= 0 ? 'positive' : 'negative'}\">\n                            ${chgPercent >= 0 ? '+' : ''}${!isNaN(chgPercent) ? chgPercent.toFixed(2) : 'N/A'}%\n                        </td>\n                        <td class=\"stock-ratio\">${!isNaN(adRatio) ? adRatio.toFixed(2) : 'N/A'}</td>\n                    </tr>\n                `;\n            }).join('');\n        }\n\n\n        // Initial fetch\n        fetchStocks();\n\n        // Refresh every minute\n        setInterval(fetchStocks, 60000);\n    });\n});\n"],"names":["document","addEventListener","stockTrackers","querySelectorAll","forEach","tracker","activeTab","tableContainer","querySelector","loadingDiv","tabs","tab","t","classList","remove","add","dataset","fetchStocks","console","error","style","display","response","fetch","stockTrackerData","apiUrl","headers","nonce","ok","Error","status","stocks","json","jsonError","renderStocks","textContent","tbody","innerHTML","map","stock","ltp","parseFloat","chg","chgPercent","chg_percent","adRatio","ad_ratio","name","isNaN","toFixed","join","setInterval"],"sourceRoot":""}