{"version":3,"file":"stock-display/view.js","mappings":"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","sources":["webpack://gb-blocks/./src/stock-display/view.js"],"sourcesContent":["document.addEventListener( 'DOMContentLoaded', function () {\n\tconst stockTrackers = document.querySelectorAll( '.stock-tracker-root' );\n\n\tstockTrackers.forEach( function ( tracker ) {\n\t\tlet activeTab = 'indices';\n\t\tconst tableContainer = tracker.querySelector(\n\t\t\t'.stock-table-container'\n\t\t);\n\t\tconst loadingDiv = tracker.querySelector( '.stock-loading' );\n\n\t\t// Initialize tabs\n\t\tconst tabs = tracker.querySelectorAll( '.stock-tab' );\n\t\ttabs.forEach( ( tab ) => {\n\t\t\ttab.addEventListener( 'click', () => {\n\t\t\t\t// Update active tab\n\t\t\t\ttabs.forEach( ( t ) => t.classList.remove( 'active' ) );\n\t\t\t\ttab.classList.add( 'active' );\n\t\t\t\tactiveTab = tab.dataset.tab;\n\t\t\t\tfetchStocks();\n\t\t\t} );\n\t\t} );\n\n\t\tasync function fetchStocks() {\n\t\t\ttry {\n\t\t\t\tif ( ! loadingDiv || ! tableContainer ) {\n\t\t\t\t\t// error occures so returning.\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tloadingDiv.style.display = 'block';\n\t\t\t\ttableContainer.style.display = 'none';\n\n\t\t\t\tconst response = await fetch(\n\t\t\t\t\t/* eslint-disable-next-line */\n                            `${ stockTrackerData.apiUrl }/${ activeTab }`,\n\t\t\t\t\t{\n\t\t\t\t\t\theaders: {\n\t\t\t\t\t\t\t/* eslint-disable-next-line */\n                                    'X-WP-Nonce': stockTrackerData.nonce,\n\t\t\t\t\t\t},\n\t\t\t\t\t}\n\t\t\t\t);\n\n\t\t\t\tif ( ! response.ok ) {\n\t\t\t\t\tthrow new Error(\n\t\t\t\t\t\t`HTTP error! Status: ${ response.status }`\n\t\t\t\t\t);\n\t\t\t\t}\n\n\t\t\t\tlet stocks;\n\t\t\t\ttry {\n\t\t\t\t\tstocks = await response.json();\n\t\t\t\t} catch ( jsonError ) {\n\t\t\t\t\tthrow new Error( 'Invalid JSON response from server' );\n\t\t\t\t}\n\n\t\t\t\trenderStocks( stocks );\n\n\t\t\t\tloadingDiv.style.display = 'none';\n\t\t\t\ttableContainer.style.display = 'block';\n\t\t\t} catch ( error ) {\n\t\t\t\tloadingDiv.textContent =\n\t\t\t\t\t'Error loading stocks data. Please try again.';\n\t\t\t}\n\t\t}\n\n\t\tfunction renderStocks( stocks ) {\n\t\t\tconst tbody = tableContainer.querySelector( 'tbody' );\n\t\t\ttbody.innerHTML = stocks\n\t\t\t\t.map( ( stock ) => {\n\t\t\t\t\tconst ltp = parseFloat( stock.ltp );\n\t\t\t\t\tconst chg = parseFloat( stock.chg );\n\t\t\t\t\tconst chgPercent = parseFloat( stock.chg_percent );\n\t\t\t\t\tconst adRatio = parseFloat( stock.ad_ratio );\n\t\t\t\t\treturn `\n                             <tr>\n                            <td class=\"stock-name\">${ stock.name }</td>\n                            <td class=\"stock-ltp\">${\n\t\t\t\t\t\t\t\t! isNaN( ltp ) ? ltp.toFixed( 2 ) : 'N/A'\n\t\t\t\t\t\t\t}</td>\n                            <td class=\"stock-chg ${\n\t\t\t\t\t\t\t\tchg >= 0 ? 'positive' : 'negative'\n\t\t\t\t\t\t\t}\">\n                                ${ chg >= 0 ? '+' : '' }${\n\t\t\t\t\t\t\t\t\t! isNaN( chg ) ? chg.toFixed( 2 ) : 'N/A'\n\t\t\t\t\t\t\t\t}\n                            </td>\n                            <td class=\"stock-percent ${\n\t\t\t\t\t\t\t\tchgPercent >= 0 ? 'positive' : 'negative'\n\t\t\t\t\t\t\t}\">\n                                ${ chgPercent >= 0 ? '+' : '' }${\n\t\t\t\t\t\t\t\t\t! isNaN( chgPercent )\n\t\t\t\t\t\t\t\t\t\t? chgPercent.toFixed( 2 )\n\t\t\t\t\t\t\t\t\t\t: 'N/A'\n\t\t\t\t\t\t\t\t}%\n                            </td>\n                            <td class=\"stock-ratio\">${\n\t\t\t\t\t\t\t\t! isNaN( adRatio )\n\t\t\t\t\t\t\t\t\t? adRatio.toFixed( 2 )\n\t\t\t\t\t\t\t\t\t: 'N/A'\n\t\t\t\t\t\t\t}</td>\n                            </tr>\n                             `;\n\t\t\t\t} )\n\t\t\t\t.join( '' );\n\t\t}\n\n\t\t// Initial fetch\n\t\tfetchStocks();\n\n\t\t// Refresh every minute\n\t\tsetInterval( fetchStocks, 60000 );\n\t} );\n} );\n"],"names":["document","addEventListener","stockTrackers","querySelectorAll","forEach","tracker","activeTab","tableContainer","querySelector","loadingDiv","tabs","tab","t","classList","remove","add","dataset","fetchStocks","style","display","response","fetch","stockTrackerData","apiUrl","headers","nonce","ok","Error","status","stocks","json","jsonError","renderStocks","error","textContent","tbody","innerHTML","map","stock","ltp","parseFloat","chg","chgPercent","chg_percent","adRatio","ad_ratio","name","isNaN","toFixed","join","setInterval"],"sourceRoot":""}