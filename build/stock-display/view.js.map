{"version":3,"file":"stock-display/view.js","mappings":"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","sources":["webpack://gb-blocks/./src/stock-display/view.js"],"sourcesContent":["document.addEventListener(\n    'DOMContentLoaded', function () {\n        const stockTrackers = document.querySelectorAll('.stock-tracker-root');\n\n        stockTrackers.forEach(\n            function ( tracker ) {\n                let activeTab = 'indices';\n                const tableContainer = tracker.querySelector(\n                    '.stock-table-container'\n                );\n                const loadingDiv = tracker.querySelector('.stock-loading');\n\n                // Initialize tabs\n                const tabs = tracker.querySelectorAll('.stock-tab');\n                tabs.forEach(\n                    ( tab ) => {\n                    tab.addEventListener(\n                            'click', () => {\n                            // Update active tab\n                                tabs.forEach(( t ) => t.classList.remove('active'));\n                            tab.classList.add('active');\n                            activeTab = tab.dataset.tab;\n                            fetchStocks();\n                            } \n                        );\n                    } \n                );\n\n                async function fetchStocks()\n                {\n                    try {\n                        if (! loadingDiv || ! tableContainer ) {\n                            // error occures so returning.\n                            return;\n                        }\n\n                        loadingDiv.style.display = 'block';\n                        tableContainer.style.display = 'none';\n\n                        const response = await fetch(\n                        /* eslint-disable-next-line */\n                            `${ stockTrackerData.apiUrl }/${ activeTab }`,\n                            {\n                                headers: {\n                                    /* eslint-disable-next-line */\n                                    'X-WP-Nonce': stockTrackerData.nonce,\n                                },\n                            }\n                        );\n\n                        if (! response.ok ) {\n                                throw new Error(\n                                    `HTTP error! Status: ${ response.status }`\n                                );\n                        }\n\n                        let stocks;\n                        try {\n                            stocks = await response.json();\n                        } catch ( jsonError ) {\n                            throw new Error('Invalid JSON response from server');\n                        }\n\n                        renderStocks(stocks);\n\n                        loadingDiv.style.display = 'none';\n                        tableContainer.style.display = 'block';\n                    } catch ( error ) {\n                        loadingDiv.textContent =\n                        'Error loading stocks data. Please try again.';\n                    }\n                }\n\n                function renderStocks( stocks )\n                {\n                    const tbody = tableContainer.querySelector('tbody');\n                    tbody.innerHTML = stocks\n                    .map(\n                        ( stock ) => {\n                        const ltp = parseFloat(stock.ltp);\n                        const chg = parseFloat(stock.chg);\n                        const chgPercent = parseFloat(stock.chg_percent);\n                        const adRatio = parseFloat(stock.ad_ratio);\n                        return `\n                             <tr>\n                            <td class=\"stock-name\">${ stock.name }</td>\n                            <td class=\"stock-ltp\">${\n                                ! isNaN(ltp) ? ltp.toFixed(2) : 'N/A'\n                            }</td>\n                            <td class=\"stock-chg ${\n                                chg >= 0 ? 'positive' : 'negative'\n                            }\">\n                                ${ chg >= 0 ? '+' : '' }${\n                                    ! isNaN(chg) ? chg.toFixed(2) : 'N/A'\n                            }\n                            </td>\n                            <td class=\"stock-percent ${\n                                chgPercent >= 0 ? 'positive' : 'negative'\n                            }\">\n                                ${ chgPercent >= 0 ? '+' : '' }${\n                                    ! isNaN(chgPercent)\n                                    ? chgPercent.toFixed(2)\n                                    : 'N/A'\n                            }%\n                            </td>\n                            <td class=\"stock-ratio\">${\n                                ! isNaN(adRatio) ? adRatio.toFixed(2) : 'N/A'\n                            }</td>\n                            </tr>\n                             `;\n                        } \n                    )\n                     .join('');\n                }\n\n                // Initial fetch\n                fetchStocks();\n\n                // Refresh every minute\n                setInterval(fetchStocks, 60000);\n            } \n        );\n    } \n);\n"],"names":["document","addEventListener","stockTrackers","querySelectorAll","forEach","tracker","activeTab","tableContainer","querySelector","loadingDiv","tabs","tab","t","classList","remove","add","dataset","fetchStocks","style","display","response","fetch","stockTrackerData","apiUrl","headers","nonce","ok","Error","status","stocks","json","jsonError","renderStocks","error","textContent","tbody","innerHTML","map","stock","ltp","parseFloat","chg","chgPercent","chg_percent","adRatio","ad_ratio","name","isNaN","toFixed","join","setInterval"],"sourceRoot":""}