{"version":3,"file":"stock-display/view.js","mappings":"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","sources":["webpack://gb-blocks/./src/stock-display/view.js"],"sourcesContent":["document.addEventListener('DOMContentLoaded', function() {\n    const stockTrackers = document.querySelectorAll('.stock-tracker-root');\n\n    stockTrackers.forEach(function(tracker) {\n        let activeTab = 'indices';\n        const tableContainer = tracker.querySelector('.stock-table-container');\n        const loadingDiv = tracker.querySelector('.stock-loading');\n\n        // Initialize tabs\n        const tabs = tracker.querySelectorAll('.stock-tab');\n        tabs.forEach((tab) => {\n            tab.addEventListener('click', () => {\n                tabs.forEach((t) => t.classList.remove('active'));\n                tab.classList.add('active');\n                activeTab = tab.dataset.tab;\n                fetchStocks();\n            });\n        });\n\n        async function fetchStocks() {\n            try {\n                if (!loadingDiv || !tableContainer) return;\n\n                loadingDiv.style.display = 'block';\n                tableContainer.style.display = 'none';\n\n                // Add cache-busting parameter to prevent browser caching\n                const url = new URL(gbBlocksStockTrackerData.jsonUrl);\n                url.searchParams.append('_', new Date().getTime());\n\n                // Fetch JSON with cache-busting\n                const response = await fetch(url.toString(), {\n                    method: 'GET',\n                    cache: 'no-store' // Force fresh data\n                });\n                \n                if (!response.ok) {\n                    throw new Error(`HTTP error! Status: ${response.status}`);\n                }\n\n                const data = await response.json();\n                console.log('Stock data loaded:', data); // Debug logging\n                \n                if (!data || !data[activeTab]) {\n                    throw new Error(`No data available for tab: ${activeTab}`);\n                }\n                \n                renderStocks(data[activeTab] || []);\n\n                loadingDiv.style.display = 'none';\n                tableContainer.style.display = 'block';\n            } catch (error) {\n                console.error('Error loading stocks:', error);\n                loadingDiv.textContent = 'Error loading stocks data. Please try again.';\n            }\n        }\n\n        function renderStocks(stocks) {\n            const tbody = tableContainer.querySelector('tbody');\n            tbody.innerHTML = stocks\n                .map((stock) => {\n                    // Generate a random number between -10 to +10\n                    const randomChange = Math.random() * 2 - 1;\n                    const ltp = stock.ltp + randomChange * stock.ltp * 0.1;\n                    const chg = stock.chg + randomChange * stock.chg * 0.1;\n                    const chgPercent = stock.chg_percent + randomChange * stock.chg_percent * 0.1;\n                    const adRatio = stock.ad_ratio + randomChange * stock.ad_ratio * 0.1;\n                    return `\n                        <tr>\n                            <td class=\"stock-name\">${stock.name}</td>\n                            <td class=\"stock-ltp\">${\n                                !isNaN(ltp) ? ltp.toFixed(2) : 'N/A'\n                            }</td>\n                            <td class=\"stock-chg ${\n                                chg >= 0 ? 'positive' : 'negative'\n                            }\">\n                                ${chg >= 0 ? '+' : ''}${\n                                    !isNaN(chg) ? chg.toFixed(2) : 'N/A'\n                                }\n                            </td>\n                            <td class=\"stock-percent ${\n                                chgPercent >= 0 ? 'positive' : 'negative'\n                            }\">\n                                ${chgPercent >= 0 ? '+' : ''}${\n                                    !isNaN(chgPercent)\n                                        ? chgPercent.toFixed(2)\n                                        : 'N/A'\n                                }%\n                            </td>\n                            <td class=\"stock-ratio\">${\n                                !isNaN(adRatio)\n                                    ? adRatio.toFixed(2)\n                                    : 'N/A'\n                            }</td>\n                        </tr>\n                    `;\n                })\n                .join('');\n        }\n\n        // Initial fetch\n        fetchStocks();\n\n        // Refresh every 5 seconds\n        setInterval(fetchStocks, 5000);\n    });\n});"],"names":["document","addEventListener","stockTrackers","querySelectorAll","forEach","tracker","activeTab","tableContainer","querySelector","loadingDiv","tabs","tab","t","classList","remove","add","dataset","fetchStocks","style","display","url","URL","gbBlocksStockTrackerData","jsonUrl","searchParams","append","Date","getTime","response","fetch","toString","method","cache","ok","Error","status","data","json","console","log","renderStocks","error","textContent","stocks","tbody","innerHTML","map","stock","randomChange","Math","random","ltp","chg","chgPercent","chg_percent","adRatio","ad_ratio","name","isNaN","toFixed","join","setInterval"],"sourceRoot":""}